<!-- dashboard.html -->

<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dashboard - Crop Yield Monitor</title>
        <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        header {
            background-color: #333;
            color: white;
            padding: 10px;
            text-align: center;
        }

        section {
            padding: 20px;
        }
        </style>
    </head>

    <body>
        <header>
            <h1>Crop Yield Monitor - Dashboard</h1>
        </header>

        <section>
            <!-- Dashboard content goes here -->
            <p>Welcome to your dashboard!</p>

        </section>

        <h2>Upload Image</h2>
        <input type="file" id="fileInput" accept="image/*">
        <h3>Bytes Output:</h3>
        <textarea id="outputBytes" rows="10" cols="80" readonly></textarea>
    </body>

    <script>
    document.getElementById('fileInput').addEventListener('change', function (event) {
        const file = event.target.files[0];
        let format = file.type;
        if (file.type === "image/png" || file.type === "image/jpeg") {
            console.log("Image format");
        } else {
            console.log("Image format: Unknown");
            alert("Invalid file");
            exit(1);
        }

        const reader = new FileReader();

        reader.onloadend = function () {
            const arrayBuffer = reader.result;
            const byteArray = new Uint8Array(arrayBuffer);
            const byteValues = Array.from(byteArray);

            document.getElementById('outputBytes').value = JSON.stringify(byteValues);

            fetch('http://localhost:9090/image/upload', {
                method: 'POST',
                credentials: 'include',
                body: JSON.stringify({ raw_image_bytes: byteValues, image_format: String(format) })
            }).then(response => response.json())
                .then(data => console.log(data));
        };

        reader.readAsArrayBuffer(file);
    });
    </script>
</html>
